import numpy as np
from matplotlib import pyplot as plt

results = np.array([[[3981, 1327, 1327, 1257, 1257, 1327, 1257, 1257, 1257, 1257, 1257, 1257, 1257, 1257, 1257],
[7543, 5727, 5518, 5308, 5168, 5168, 5169, 5099, 5169, 5099, 5168, 5308, 5169, 5308, 5168],
[5168, 5238, 5099, 5238, 5238, 5169, 5098, 5168, 5448, 5098, 5168, 5099, 5099, 5168, 5098]],

[[6845, 2095, 1886, 1886, 1885, 1746, 1816, 1816, 1816, 1816, 1816, 1816, 1816, 1746, 1815],
[12642, 10546, 1956, 1816, 1815, 1816, 1885, 1816, 1816, 1048, 1047, 1047, 1118, 1048, 1047],
[4400, 4121, 4051, 3911, 3841, 9079, 8939, 9219, 9359, 9079, 9149, 9009, 9149, 9010, 14876]],

[[4470, 1537, 4261, 3632, 3492, 6077, 3562, 3562, 3562, 3492, 3492, 3422, 3423, 7124, 3562],
[8312, 6286, 6356, 6076, 6006, 8520, 6076, 6077, 6007, 5936, 5936, 6076, 5936, 8032, 6006],
[6985, 6845, 6984, 6705, 6914, 9149, 6844, 6775, 6844, 6915, 6845, 6705, 7124, 6844, 6915]],

[[7752, 3772, 3423, 3352, 3352, 3352, 3353, 3353, 3352, 3352, 3353, 3353, 3352, 3352, 3353],
[22171904, 14223000, 4323067, 4343111, 4326210, 4316362, 4321949, 4334102, 4317549, 4311683, 4310285, 4330750, 4307772, 4348839, 4289403],
[1273802114, 1273565910, 1280857672, 1278812076, 1279130485, 1267960689, 1267899508, 1267841749, 1267688237, 1268247950, 1267668054, 1267894971, 1267780780, 1268057493, 1267932267]],

[[6705, 4959, 3352, 3213, 3282, 3213, 3212, 3283, 3282, 3283, 3282, 3213, 3212, 3213, 3282],
[26668947, 25994415, 16261054, 16257353, 16194565, 16149377, 16183809, 16137713, 16178292, 16154825, 16179618, 16152869, 16178082, 16159364, 16183180],
[2352299436, 2357376097, 2354324292, 2357532266, 2354422911, 2358278110, 2356027669, 2357577739, 2354556454, 2356933870, 2355307815, 2356762900, 2354832475, 2357047788, 2354716331]],

[[6216, 4051, 3772, 3702, 3701, 3772, 3771, 3702, 3632, 3911, 3702, 3702, 3701, 3841, 3772],
[33559397, 31653066, 21884295, 21856778, 23223372, 22637120, 21908461, 21901336, 23276941, 22439608, 21909299, 21945966, 23278617, 22433461, 21915445],
[2881811315, 2999644469, 2942093093, 2883205993, 2883444505, 2997812250, 2948805458, 2884401555, 2888684605, 2999432729, 2947036935, 2889284693, 2889475502, 3004157187, 2948772651]],

[[26959, 17251, 15645, 15714, 16203, 16343, 16133, 15644, 15784, 18368, 18578, 16971, 18159, 15575, 16622],
[59850645, 32742811, 32550466, 32941581, 51365356, 51449935, 51171965, 51426677, 51197946, 50937715, 51575789, 51614971, 51460341, 51284759, 51248302],
[4645388299, 4655430574, 4640770854, 4661257759, 4637441989, 4658211614, 4642228602, 4654737200, 4661171168, 4658732295, 4673656301, 4655834424, 4661595397, 4637832427, 4649220273]]])


labels = [
'pavliuchenkov_d_m [T*]',
'kiselev_e_l [T*]',
'kutakova_a_p [T*]',
'manakov_d_d [T*]',
'orusov_t_d [T*]',
'dron_a_a [T*]',
'orusov_t_d [T***]']


colors = ['red', 'orange', 'yellow', 'green', 'lightblue', 'blue', 'purple']


def plot_res(id, title, size):
    plt.xticks(rotation=50)
    # print("Mean time per volume unit:", np.mean(results[:,id,:] / size, axis=1))
    bp = plt.boxplot(results[:,id,:].T / size,
        notch=True,
        labels=labels,
        patch_artist=True)
    for box, color in zip(bp['boxes'], colors):
        box.set_facecolor(color)
    plt.title(title)
    plt.show()

plot_res(0, "Small 10^3", 10**3)
plot_res(1, "Medium 100^3", 100**3) 
plot_res(2, "Huge 900^3", 900**3)

print("Mean time for T*:", np.mean(results[:6,:,:], axis=(0, 2)))
print("Mean time for T***:", np.mean(results[6,:,:], axis=(1)))
